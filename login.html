<!doctype html>

<html>
  <head>
    <title>Openblog Github Login</title>
    <script src="js/lib/github.bundle.min.js"></script>

    <script src="js/globals.js"></script>
    <script src="js/auth.js"></script>
    <script>
      function redirect() {
        var params = window.location.search;
        if (params.indexOf('code') !== -1) {
          window.github._request(
            'POST',
            'https://github.com/login/oauth/access_token',
            {
              client_id: '92acf5c0002534e0edb3',
              client_secret: '7fe6aea5d9800a8dc244a5217b592aebc01a8c1b',
              code: params.replace('?code=', ''),
              redirect_uri: 'https://' + window.USERNAME + '.github.io/' + window.REPO + '/login.html'
            },
            function (error, data) {
              console.log(error, data);
              var url = 'https://' + window.USERNAME + '.github.io/' + window.REPO;
              window.location.href = url;
            }
          );
        } else if (params.indexOf('access_token') !== -1) {
          console.log(params);
        }
      }
    </script>
  </head>
  <body onload="authorize(); redirect()">
  </body>
</html>
